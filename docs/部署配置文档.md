# 部署配置文档

## 1. 系统架构

### 1.1 技术栈
- **前端**：Vue 3 + Vite + Element Plus + Pinia
- **后端**：Spring Boot 3.2.0 + MyBatis Plus + MySQL 8.0
- **认证**：Spring Security + JWT
- **API**：RESTful API

### 1.2 系统依赖
- **前端**：Node.js 16+
- **后端**：JDK 17+, Maven 3.6+
- **数据库**：MySQL 8.0+

## 2. 环境配置

### 2.1 数据库配置
1. 创建数据库：`CREATE DATABASE thesis_management CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
2. 导入初始化数据：执行 `backend/src/main/resources/init.sql`
3. 配置数据库连接：修改 `backend/src/main/resources/application.yml` 中的数据库连接信息

### 2.2 后端配置
1. **端口配置**：默认端口为 8081，可在 `application.yml` 中修改
2. **上下文路径**：默认 `/api`，可在 `application.yml` 中修改
3. **JWT 配置**：修改 `application.yml` 中的 JWT 密钥
4. **文件上传配置**：修改 `application.yml` 中的上传目录

### 2.3 前端配置
1. **API 地址**：修改 `frontend/src/stores/index.js` 中的 API 地址
2. **构建配置**：修改 `frontend/vite.config.js` 中的构建配置

## 3. 部署步骤

### 3.1 后端部署

#### 3.1.1 开发环境部署
```bash
# 进入后端目录
cd backend

# 安装依赖
mvn clean install

# 启动服务
mvn spring-boot:run
```

#### 3.1.2 生产环境部署
```bash
# 构建可执行jar包
mvn clean package -DskipTests

# 启动服务
java -jar target/thesis-management-system-1.0.0.jar
```

### 3.2 前端部署

#### 3.2.1 开发环境部署
```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

#### 3.2.2 生产环境部署
```bash
# 构建生产版本
npm run build

# 部署构建产物
# 将 dist 目录部署到 Nginx 或其他静态文件服务器
```

## 4. 启动脚本

### 4.1 后端启动脚本
创建 `backend/start.sh`：
```bash
#!/bin/bash

# 进入脚本所在目录
cd "$(dirname "$0")"

# 启动后端服务
mvn spring-boot:run
```

### 4.2 前端启动脚本
创建 `frontend/start.sh`：
```bash
#!/bin/bash

# 进入脚本所在目录
cd "$(dirname "$0")"

# 启动前端服务
npm run dev
```

### 4.3 赋予执行权限
```bash
chmod +x backend/start.sh
chmod +x frontend/start.sh
```

## 5. 常见问题排查

### 5.1 端口冲突
- **问题**：启动服务时提示端口被占用
- **解决**：修改 `application.yml` 中的端口配置

### 5.2 数据库连接失败
- **问题**：启动后端服务时提示数据库连接失败
- **解决**：检查数据库服务是否启动，连接信息是否正确

### 5.3 前端API请求失败
- **问题**：前端请求API时提示404或500错误
- **解决**：检查后端服务是否启动，API地址是否正确

### 5.4 登录失败
- **问题**：登录时提示用户名或密码错误
- **解决**：检查用户是否存在，密码是否正确，数据库中密码是否为哈希值

### 5.5 权限不足
- **问题**：访问某些页面时提示权限不足
- **解决**：检查用户角色是否正确，JWT token是否有效

## 6. 监控与维护

### 6.1 日志配置
- 后端日志：`backend/src/main/resources/application.yml` 中的 logging 配置
- 前端日志：浏览器控制台

### 6.2 性能监控
- 后端：使用 Spring Boot Actuator
- 前端：使用浏览器开发者工具

### 6.3 安全维护
- 定期更新依赖包
- 定期修改 JWT 密钥
- 定期备份数据库

## 7. 系统更新

### 7.1 后端更新
```bash
# 拉取代码
git pull

# 构建并重启服务
mvn clean package -DskipTests
java -jar target/thesis-management-system-1.0.0.jar
```

### 7.2 前端更新
```bash
# 拉取代码
git pull

# 构建并部署
npm install
npm run build
# 将 dist 目录部署到静态文件服务器
```

## 8. 联系方式

- **技术支持**：请联系系统管理员
- **问题反馈**：请提交 Issue 到项目仓库

---

**部署完成后，请访问以下地址：**
- 前端：`http://localhost:5173`（开发环境）或部署服务器地址（生产环境）
- 后端：`http://localhost:8081/api`
- API文档：`http://localhost:8081/api/swagger-ui.html`